<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="icon" href="swayam.png">
  <title>Swayam Login</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
  
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      display: flex; justify-content: center; align-items: center;
      min-height: 100vh; transition: background 0.4s, color 0.4s;
      overflow: hidden; position: relative;
    }
    body.dark { background: #0d1117; color: #fff; }
    body.light { background: #f0f0f0; color: #000; }

    body::before {
      content: ""; position: absolute; top: 0; left: 0;
      width: 100%; height: 100%;
      background: url("https://www.transparenttextures.com/patterns/circuits.png");
      opacity: 0.3; z-index: -1;
    }
    body.dark::before { filter: invert(1) opacity(0.25); }

    .container { width: 100%; max-width: 420px; padding: 20px; z-index: 1; }
    .card {
      background: rgba(255, 255, 255, 0.07);
      backdrop-filter: blur(15px);
      border-radius: 20px; padding: 30px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }

    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .logo { width: 70px; height: 70px; }

    /* ðŸŒž/ðŸŒ™ Toggle  */
    .toggle {
      width: 50px; height: 25px;
      background: #6ba9ff; border-radius: 50px;
      cursor: pointer; display: flex; align-items: center;
      padding: 3px; transition: background 0.4s;
    }
    .circle {
      width: 20px; height: 20px; border-radius: 50%;
      background: yellow; color: black;
      display: flex; justify-content: center; align-items: center;
      font-size: 12px; transition: transform 0.4s, background 0.4s, color 0.4s;
    }
    .toggle.active .circle { transform: translateX(25px); background: #333; color: white; }

    .tabs { display: flex; justify-content: center; margin-bottom: 20px; }
    .tab { flex: 1; padding: 10px; cursor: pointer; background: transparent; color: gray; font-weight: bold; border: none; }
    .tab.active { color: #2563eb; border-bottom: 2px solid #2563eb; }

    h2 { text-align: center; margin: 10px 0; }
    .subtitle { text-align: center; font-size: 14px; color: gray; margin-bottom: 15px; }
    .form { display: none; }
    .form.active { display: block; }

    form input {
      width: 100%; padding: 12px; margin-bottom: 12px;
      border: 1px solid #666; border-radius: 8px; outline: none;
    }

    .options { display: flex; justify-content: space-between; align-items: center; font-size: 14px; margin-bottom: 15px; }

    .btn {
      width: 100%; padding: 12px; margin: 6px 0;
      border: none; border-radius: 8px; cursor: pointer;
      font-size: 14px; font-weight: bold;
      display: flex; align-items: center; justify-content: center; gap: 8px;
    }
    .primary { background: #2563eb; color: #fff; }
    .primary:hover { background: #1e40af; }
    .google { background: #db4437; color: #fff; font-weight: bold; }
    .github { background: #333; color: #fff; font-weight: bold; }
    .linkedin { background: #0077b5; color: #fff; font-weight: bold; }

    .divider { text-align: center; margin: 15px 0; color: gray; position: relative; }
    .divider span { background: inherit; padding: 0 10px; position: relative; z-index: 1; }
    .divider::before { content: ""; position: absolute; top: 50%; left: 0; right: 0; height: 1px; background: #666; z-index: 0; }

    .terms { text-align: center; font-size: 12px; margin-top: 10px; }
    .link { color: #3b82f6; text-decoration: none; }
    .link:hover { text-decoration: underline; }
  </style>
</head>
<body class="dark">
  <div class="container">
    <div class="card">
      <div class="header">
        <img src="swayam.png" alt="Swayam Logo" class="logo">
        <div class="toggle" id="modeToggle"><div class="circle"><i class="fas fa-sun"></i></div></div>
      </div>

      <div class="tabs">
        <button id="loginTab" class="tab active">Login</button>
        <button id="signupTab" class="tab">Signup</button>
      </div>

      <form id="loginForm" class="form active">
        <h2>Welcome Back</h2>
        <p class="subtitle">Login to continue your learning journey</p>
        <input type="email" id="loginEmail" placeholder="Email address" required>
        <input type="password" id="loginPassword" placeholder="Password" required>

        <div class="options">
          <label><input type="checkbox" id="remember"> Remember Me</label>
          <a href="#" id="forgotLink" class="link">Forgot Password?</a>
        </div>

        <div id="loginError" style="color:#ff6b6b;margin-bottom:8px;"></div>
        <button type="submit" id="loginBtn" class="btn primary">Login</button>

        <div class="divider"><span>OR</span></div>

        <button type="button" id="googleBtn" class="btn google">
          <img src="https://www.svgrepo.com/show/355037/google.svg" width="20" alt="Google"> <b>Login with Google</b>
        </button>
        <button type="button" id="githubBtn" class="btn github">
          <img src="https://www.svgrepo.com/show/475654/github-color.svg" width="20" alt="GitHub"> <b>Login with GitHub</b>
        </button>
        <button type="button" id="linkedinBtn" class="btn linkedin">
          <img src="https://www.svgrepo.com/show/448234/linkedin.svg" width="20" alt="LinkedIn"> <b>Login with LinkedIn(comming soon)</b>
        </button>
      </form>

      <form id="signupForm" class="form">
        <h2>Create Account</h2>
        <p class="subtitle">Join Swayam and start your journey</p>
        <input type="text" id="signupName" placeholder="Full Name" required>
        <input type="email" id="signupEmail" placeholder="Email address" required>
        <input type="password" id="signupPassword" placeholder="Password" required>
        <input type="password" id="confirmPassword" placeholder="Confirm Password" required>

        <div id="signupError" style="color:#ff6b6b;margin-bottom:8px;"></div>
        <div id="signupSuccess" style="color:#2ecc71;margin-bottom:8px;"></div>
        <button type="submit" id="signupBtn" class="btn primary">Sign Up</button>
      </form>

      <p class="terms">By continuing, you agree to our <a href="#" class="link">Terms</a> & <a href="#" class="link">Privacy Policy</a>.</p>
    </div>
  </div>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    // Replace these with your values (yours are already present; keep anon key only)
    const SUPABASE_URL = "https://xyakbprycadzleexjpoi.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh5YWticHJ5Y2FkemxlZXhqcG9pIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1MDAyNTMsImV4cCI6MjA3ODA3NjI1M30.z4IqtEj02jyPE9d5bKH1UP_lxRm3ZcBCUcy7t5LUvrg";

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const DASHBOARD_URL = "/dashboard.html";

    // Theme toggle
    const toggle = document.getElementById("modeToggle");
    const circle = toggle.querySelector(".circle");
    toggle.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      document.body.classList.toggle("light");
      toggle.classList.toggle("active");
      circle.innerHTML = document.body.classList.contains("dark")
        ? '<i class="fas fa-sun"></i>'
        : '<i class="fas fa-moon"></i>';
    });

    // Tabs
    const loginTab = document.getElementById("loginTab");
    const signupTab = document.getElementById("signupTab");
    const loginForm = document.getElementById("loginForm");
    const signupForm = document.getElementById("signupForm");
    loginTab.addEventListener("click", () => { loginTab.classList.add("active"); signupTab.classList.remove("active"); loginForm.classList.add("active"); signupForm.classList.remove("active"); });
    signupTab.addEventListener("click", () => { signupTab.classList.add("active"); loginTab.classList.remove("active"); signupForm.classList.add("active"); loginForm.classList.remove("active"); });

    // Session helpers for "Remember Me"
    function persistSessionToSessionStorage(session) {
      if (!session) return;
      sessionStorage.setItem("sb-session", JSON.stringify(session));
    }
    function useSessionFromSessionStorage() {
      const raw = sessionStorage.getItem("sb-session");
      if (!raw) return null;
      try { return JSON.parse(raw); } catch { return null; }
    }

    async function signInWithEmail(email, password, remember) {
      const { data, error } = await supabase.auth.signInWithPassword({ email, password });
      if (error) throw error;
      if (!remember && data.session) persistSessionToSessionStorage(data.session);
      return data.user;
    }

    async function signUpWithEmail(name, email, password) {
      const { data, error } = await supabase.auth.signUp({
        email,
        password,
        options: { data: { name } }
      });
      if (error) throw error;
      return data.user;
    }

    async function getSession() {
      const ss = useSessionFromSessionStorage();
      if (ss) return { data: { session: ss } };
      return supabase.auth.getSession();
    }

    // Login form
    const loginEmail = document.getElementById("loginEmail");
    const loginPassword = document.getElementById("loginPassword");
    const remember = document.getElementById("remember");
    const loginBtn = document.getElementById("loginBtn");
    const loginError = document.getElementById("loginError");

    loginForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      loginError.textContent = "";
      loginBtn.disabled = true;
      try {
        await signInWithEmail(loginEmail.value.trim(), loginPassword.value, remember.checked);
        window.location.href = DASHBOARD_URL;
      } catch (err) {
        loginError.textContent = err.message || "Login failed";
      } finally {
        loginBtn.disabled = false;
      }
    });

    // Signup form
    const signupName = document.getElementById("signupName");
    const signupEmail = document.getElementById("signupEmail");
    const signupPassword = document.getElementById("signupPassword");
    const confirmPassword = document.getElementById("confirmPassword");
    const signupBtn = document.getElementById("signupBtn");
    const signupError = document.getElementById("signupError");
    const signupSuccess = document.getElementById("signupSuccess");

    signupForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      signupError.textContent = "";
      signupSuccess.textContent = "";
      if (signupPassword.value !== confirmPassword.value) {
        signupError.textContent = "Passwords donâ€™t match.";
        return;
      }
      signupBtn.disabled = true;
      try {
        await signUpWithEmail(signupName.value.trim(), signupEmail.value.trim(), signupPassword.value);
        signupSuccess.textContent = "Account created. Check your email to verify.";
        const { data: { session } } = await supabase.auth.getSession();
        if (session) window.location.href = DASHBOARD_URL;
      } catch (err) {
        signupError.textContent = err.message || "Signup failed";
      } finally {
        signupBtn.disabled = false;
      }
    });

    // Forgot password
    document.getElementById("forgotLink").addEventListener("click", async (e) => {
      e.preventDefault();
      const email = prompt("Enter your email for reset link:");
      if (!email) return;
      const { error } = await supabase.auth.resetPasswordForEmail(email, {
        redirectTo: `${location.origin}/reset.html`
      });
      if (error) alert(error.message);
      else alert("Reset link sent. Check your inbox.");
    });

    // OAuth
  async function oauth(provider) {
  const { error } = await supabase.auth.signInWithOAuth({
    provider,
    options: {
      redirectTo: "https://swayam-learning.vercel.app/dashboard.html"
    }
  });
  if (error) alert(error.message);
}
    document.getElementById("googleBtn").addEventListener("click", () => oauth("google"));
    document.getElementById("githubBtn").addEventListener("click", () => oauth("github"));
    // For LinkedIn, dashboard supports 'linkedin' or 'linkedin_oidc' depending on setup
    document.getElementById("linkedinBtn").addEventListener("click", () => oauth("linkedin"));

    // Optional: redirect if already logged in
    (async () => {
      const { data: { session } } = await getSession();
      if (session) {
        // window.location.href = DASHBOARD_URL;
      }
    })();
  </script>
</body>

</html>
